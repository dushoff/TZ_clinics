---
title: "Survival_overview"
author: "mike li"
date: "February 15, 2016"
output: html_document
---

```{r}
library(survival)
library(ggplot2)
library(dplyr)
library(gridExtra)
load("survival.sample.RData")
```

##Intro

Bla Bla Bla

##

![](./picture/recyclepicture.png)

```{r, echo=FALSE, warning=FALSE, message=FALSE}

laSurv <- survfit(
  Surv(followTime, LTFU_status) ~ 1
  , data=survTable
)


g1 <- (plot(laSurv,mark.time=TRUE,main='Linked Survival: Enrolling in program (getting check up)',xlab='Day Lag'))

print(g1)

print(sum(laSurv$n.event)/laSurv$n)
```

```{r art and eligible, echo=FALSE, message=FALSE, warning=FALSE}
arvSurv <- survfit(
  Surv(arvFollowTime, arv_ever, type= "right") ~ 1
 , data=survTable
   # ,data=aaa
)



arv <- data.frame(
  time=arvSurv$time, 
  nrisk = arvSurv$n.risk, 
  events <- arvSurv$n.event
)

## S(t) = PRODUCT ( (#risk - #event) / #risk )
## It is weird no matter how you look at it.

arv <- arv %>% mutate(
  surv = cumprod((nrisk-events)/nrisk),
  cumprob = 1-surv, 
  followUp = time/year
)

### This is the cumulative probability plot of Enrolling in ART out of the population	
g2<- (ggplot(arv, aes(followUp,cumprob))
      + geom_line() 
      + ggtitle('Cumulative Probability of Getting ART (POPULATION)')
      + theme_bw()
)

print(g2)
#grid.arrange(g1,g2,ncol=2)


```


